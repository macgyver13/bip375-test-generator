description: "Signer constraint validation errors"

test_cases:
  - description: "input eligibility: segwit version greater than 1 in transaction inputs with silent payments output"
    validation_result: "invalid"
    checks: ["input_eligibility"]
    inputs:
      - type: "p2wpkh"
        amount: 100000
        key_derivation_suffix: "segwit_v2"
    outputs:
      - type: "silent_payment"
        amount: 95000
        scan_key_id: "default"
    scan_keys:
      - key_id: "default"
    control_override:
      use_segwit_v2_input: True

  - description: "input eligibility: non-SIGHASH_ALL signature on input with silent payments output"
    validation_result: "invalid"
    inputs:
      - type: "p2wpkh"
        amount: 100000
        key_derivation_suffix: "non_sighash_all"
    outputs:
      - type: "silent_payment"
        amount: 95000
        scan_key_id: "default"
    scan_keys:
      - key_id: "default"
    control_override:
      wrong_sighash_for_input: 0
